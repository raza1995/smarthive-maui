const mongoose = require("mongoose");

const endpointSchema = mongoose.Schema(
  {
    company_id: String,
    account_id: String,
    integration_category_type: String,
    machine: {
      is_deleted: Boolean,
      reboot_required_reason: Array,
      scan_age_days: Number,
      last_day_seen: String,
      isolated: Boolean,
      suspicious_activity_count: Number,
      infection_count: Number,
      reboot_required: Number,
      last_scanned_at: String,
      tags: {},
      group_id: String,
      id: String,
      created_at: String,
      account_id: String,
      account: {
        parent: String,
        name: String,
        options: {
          msp: {
            name: String,
          },
        },
        deleted: Boolean,
      },
      root_group_id: String,
      group_name: String,
      policy_name: String,
      policy_id: String,
      online: String,
    },
    agent: Object,
    link: String,
    stats: {
      assets: {
        last_scanned_at: String,
        vulnerabilities_found: {
          total: Number,
        },
        os_patches_available: Number,
      },
    },
    protection_status: String,
    root_fields: {
      protection_status: String,
      display_name: String,
    },
    display_name: String,
    status: Object,
  },
  {
    timestamps: true,
  }
);

const malwareBytesEndpointModel = mongoose.model(
  "malwareBytes_endpoints",
  endpointSchema
);

export default malwareBytesEndpointModel;
