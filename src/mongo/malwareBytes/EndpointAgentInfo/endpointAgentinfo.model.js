const mongoose = require("mongoose");

const endpointAgentInfoSchema = mongoose.Schema(
  {
    company_id: String,
    asset_id: String,
    started_at_offset: Date,
    nics: [],
    available_software_updates: Object,
    has_alerts: Boolean,
    is_software_update_available: false,
    engine_version: String,
    policy_etag: String,
    last_user: String,
    started_at_local: String,
    plugins: [],
    fully_qualified_host_name: String,
    machine_id: String,
    account_id: String,
    machine_ip: String,
    source_location: {
      city: String,
      country: String,
      country_iso: String,
      continent: String,
      accuracy_radius: Number,
      point: { lat: Number, lon: Number },
      time_zone: String,
      postal_code: String,
      subdivisions: [],
      anonymous_proxy: Boolean,
    },
    group_id: String,
    os_info: {
      os_type: String,
      os_version: String,
      os_platform: String,
      os_architecture: String,
      os_release_name: String,
    },
    host_name: String,
    serial_number: String,
    agent_info_last_updated_at: Date,
    last_seen_at: Date,
  },
  {
    timestamps: true,
  }
);

const malwareBytesEndpointAgentInfoModel = mongoose.model(
  "malwareBytes_endpoints_agent_info",
  endpointAgentInfoSchema
);

export default malwareBytesEndpointAgentInfoModel;
